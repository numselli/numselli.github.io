<!DOCTYPE HTML>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Compete with other Discord servers to get the highest count.">
		<title>Counting</title>
		<link rel="icon" href="assets/img/counticon.png" type="image/x-icon"/>
		<script src="assets/js/jquery.min.js"></script>
		<script async src="https://arc.io/widget.min.js#vjBL7bu4"></script>
		<link rel="stylesheet" href="assets/css/main.css" />
		<meta name="theme-color" content="#e00051">
		<script src="https://getinsights.io/js/insights.js"></script>
		<script>
			insights.init("myD4woT_qCdSytjV")
			insights.trackPages()
		</script>

		<!-- custom css and js -->
		<style>
			html,body{background-color: #001040; overflow-x: hidden; width: 100%;height: 100%; margin:0;}
			html::-webkit-scrollbar {display: none;}
			html{-ms-overflow-style: none;scrollbar-width: none;}

			a:link,a:visited,a:hover {color:white;background-color: transparent;text-decoration: none;}
			.button {color: #ffffff !important;text-transform: uppercase;background: #6c6c6c58;padding: 20px;border: 4px solid #ff0066 !important;border-radius: 6px;display: inline-block;transition: all 0.3s ease 0s;}
			.button:hover {color: #ffffff !important;border-radius: 50px;border-color: #ff0066 !important;transition: all 0.3s ease 0s;}
			.button:link,.button:visited {text-decoration: none;}
				
			table{width: 50%;height: 95%; background-color:#aaaaaa; margin: 0 auto;}
			.sortbutton {justify-content: center;background: #102E3B;color: #f9f9f8;}
			.sortbutton:hover, .sortbutton a:hover {background: #4d4e4f;color: #f9f9f8;border: #4d4e4f;}
			.sortbutton a {background: #102E3B;padding: 7px 35px;font-size: 16px;color: #f9f9f8;border: #102E3B;}
			.tr{background-color:#d2d2d2;outline: 0.5px solid #000000;}
			td{text-align: center; color: #000000;}
			.tr:nth-child(odd){background-color:#aaaaaa;outline: 0.5px solid #000000;}

			.guildimg{vertical-align: middle;max-height: 100px;max-width: 100px;}

			.home{padding-bottom: 15%;}
		</style>
		<script>
			$(document).ready(pageLoad);
			$(window).bind('hashchange', pageLoad);

			// set golabl vars
			var gloabldata = {
				"APIurl":'https://d525bebe867a.ngrok.io',
				"scorestabledata":[],
				"scorestabledatasortdirection": false,
				"userscorestabledata":[],
				"usertabledatasortdirection": false,
				"commonguilds":{}
			}

			// headder, title adujust
			async function pageLoad(){
				switch((window.location.hash).replace("#","")){
					case `scores`:
						$("#title").text("SCORES")
						document.title = "Scores"
						$("#main").removeClass("home");
						if ($("#scoresTableBody").find("tr").length<=0){
							gloabldata.scorestabledata = await getAPIdata("scores")
							if (gloabldata.scorestabledata){
								gloabldata.scorestabledata.map(({url,name,cs,hs})=>{
									$('#scoresTableBody').append(`<tr class="tr"><td><img class="guildimg" src="${url}" alt="${name}'s guild icon" style="border-radius: 50%; width:40px;" loading="lazy" onError="this.onerror=null;this.src='assets/img/error.png';"></td><td>${name}</td><td>${cs}</td><td>${hs}</td></tr>`);
								})
							}
						}
					break;
					case `userscores`:
						$("#title").text("USER SCORES")
						document.title = "User scores"
						$("#main").removeClass("home");
						if ($("#userscoresTableBody").find("tr").length<=0){
							gloabldata.userscorestabledata = (await getAPIdata("userscores")).slice(0, 50)
							gloabldata.userscorestabledata.forEach(async({userscoresrank, userscoresname, userscorestotal}) => {
								$('#userscoresTableBody').append(`<tr><td>${userscoresrank}</td><td>${userscoresname}</td><td>${userscorestotal}</td></tr>`);
							})
						}
					break;
					case `privacy`:
						$("#title").text("PRIVACY")
						document.title = "PRIVACY"
						$("#main").removeClass("home");
					break;
					case `countingCheats`:
						let randomVideos = [
							"https://www.youtube.com/watch?v=jeg_TJvkSjg",
							"https://www.youtube.com/watch?v=dQw4w9WgXcQ"
						]
						window.location.replace(randomVideos[Math.floor(Math.random() * randomVideos.length)]);
					break;
					
					default:
						$("#main").addClass("home");
						$("#title").text("COUNTING")
						document.title = "Counting"
					break;
				}
			}
			async function getAPIdata(item) {	
				console.log(item)			
				var ajaxdata = await fetch(`${gloabldata.APIurl}/get/${item}`)
					.then(response => {
						if (response.ok){
							return response.json()
						}else{
							return
						}
					})
					console.log(ajaxdata)
				return ajaxdata
			}
			async function sortdata(columnname, tablename){
				// flick sort arrow
				let tablehead = $(`#${tablename} table thead`).children()[1], dataType;
				Array.from(tablehead.childNodes, async(e,index) => {
					if (e.innerHTML && e.innerHTML.includes(`<i id=`)){
						if (e.innerHTML.split(`<i id="`)[1].split(`" class=`)[0] == columnname){
							dataType = e.getAttribute("dataType")
							gloabldata[`${tablename}tabledatasortdirection`] = !gloabldata[`${tablename}tabledatasortdirection`];
							document.getElementById(columnname).classList = gloabldata[`${tablename}tabledatasortdirection`] ? 'fa fa-sort-up' : 'fa fa-sort-down'
						}else{
							document.getElementById(e.innerHTML.split(`<i id="`)[1].split(`" class=`)[0]).classList = '';
						}
					}
				});
				// sort data
				gloabldata[`${tablename}tabledata`] = gloabldata[`${tablename}tabledata`].sort((p1, p2) => {
					switch (dataType){
						case `int`:
							return gloabldata[`${tablename}tabledatasortdirection`] ? p1[columnname] - p2[columnname] : p2[columnname] - p1[columnname];
						break;
						case `string`:
							return gloabldata[`${tablename}tabledatasortdirection`] ? (p1[columnname] > p2[columnname]) - (p1[columnname] < p2[columnname]) : (p2[columnname] > p1[columnname]) - (p2[columnname] < p1[columnname]);
						break;	
					}
				});
				// update table
				await $(`#${tablename}TableBody`).empty()
				gloabldata[`${tablename}tabledata`].map(data=>{
					let rowdata = (tablename=="scores") ? `<tr class="tr"><td><img class="guildimg" src="${data.url || data.fallback}" onerror="if (this.src != '${data.fallback}') this.src = '${data.fallback}';" style="border-radius: 50%; width:40px;"></td><td>${data.name}</td><td>${data.cs}</td><td>${data.hs}</td></tr>` : `<tr><td>${data.userscoresrank}</td><td>${data.userscoresname}</td><td>${data.userscorestotal}</td></tr>`
					document.getElementById(`${tablename}TableBody`).innerHTML += rowdata;
				})
			}
		</script>
	</head>

	<body>
		<!-- Wrapper-->
		<div>
			<!-- Nav -->
			<nav id="nav">
				<a href="#"><img style="max-width:100%;width:100px;" alt="Counting's logo"src="assets/img/counticon.png"></a>
				<h1 id="title">COUNTING</h1>
			</nav>

			<!-- Main -->
			<div id="main" style="height: 100%; width: 100%; margin: 0 auto;" class="home">
				<!-- home -->
				<article id="home" class="panel intro" style="width: 100%;">
					<nav align="center" id="nav" style="width: 50%; margin: 0 auto; padding-top: 6%;">
						<div style="float: left; padding-left: 16%;"><a class="button"href="https://discord.com/oauth2/authorize?client_id=726560538145849374&scope=bot&permissions=3136"rel="nofollow noopener" target="_blank">INVITE</a></div>
						<div style="float: right; padding-right: 16%;"><a class="button" href="#scores">SCORES</a></div>
					<nav>
				</article>

				<!-- guild socres -->
				<article id="scores" class="panel" style="width: 100%; margin: 0 auto;">
					<table>
						<thead>						
							<tr>
								<th class="sortbutton" colspan="2" onclick="window.location.hash = 'userscores'">User scores</th>
								<th class="sortbutton" colspan="2" onclick="window.location.hash = 'scores'">Channel scores</th>
							</tr>
							<tr>
								<th class="sortbutton">Icon</th>
								<th onclick="sortdata('name', 'scores')" class="sortbutton" dataType="string">Name <i id="name" class=""></i></th>
								<th onclick="sortdata('cs', 'scores')" class="sortbutton" dataType="int">Current Score <i id="cs" class=""></i></th>
								<th onclick="sortdata('hs', 'scores')" class="sortbutton" dataType="int">High Score <i id="hs" class=""></i></th>
							</tr>
						</thead>
						<tbody id='scoresTableBody'>
						</tbody>
					</table>
				</article>
				<!-- user scores -->
				<article id="userscores" class="panel" style="width: 100%; margin: 0 auto;">
					<table>
						<thead>
							<tr>
								<th class="sortbutton" colspan="2" onclick="window.location.hash = 'userscores'">User scores</th>
								<th class="sortbutton" colspan="2" onclick="window.location.hash = 'scores'">Channel scores</th>
							</tr>
							<tr>
								<th class="sortbutton" onclick="sortdata('userscoresrank', 'userscores')" dataType="int">Rank <i id="userscoresrank" class=""></i></th>
								<th class="sortbutton" onclick="sortdata('userscoresname', 'userscores')" dataType="string">Username <i id="userscoresname" class=""></i></th>
								<th class="sortbutton" onclick="sortdata('userscorestotal', 'userscores')" dataType="int">Total <i id="userscorestotal" class=""></i></th>
							</tr>
						</thead>
						<tbody id='userscoresTableBody'>
						</tbody>
					</table>
				</article>
				<!-- privacy -->
				<article id="privacy" class="panel" style="width: 100%; margin: 0 auto;">
					<h4>Stored Data</h4>
					<p>
						The bot will store information automatically when being invited to a new Discord Server. This information can include:<br>
						◉ The servers id<br>
						◉ The bot's default prefix<br>
					</p>
					<h4>Updating Data</h4>
					<p>
						The stored data may be updated when using commands, voting on bot listing stites, or by becoming pateron. Updating data will require the action of a user. We may store any sort of Snowflake IDs provided by Discord and user input associated with our bot's features in order to provide features may provide. We will not knowingly store sensitive data, identifying data, unnecessary data, or data which is not used in our bot's features. By interacting with our bot, you authorize us to store said data.
					</p>
					<h4>Removal of Data</h4>
					<p>
						Users may manually request this data to be deleted. Additionally, users who own or maintain said server can delete data using the associated command, or by making a request in a support server we have and proving that they own or maintain the guild in question. Guild-specific data is stored with a reference to the guild, and will be deleted with guild data. Only the server owner may ask for the removal of data from their server through the bot's support server. We may ask for verification of ownership of the Server.
					</p> 
				</article>
			</div>

			<!-- Footer -->
			<div id="footer" style="text-align: center; padding: 2em 0 0 0; font-size: 0.75em;">
				<div align="center"style="position:relative; bottom:0; width:100%; text-align:center; flex-shrink: 0;">
					<div style="padding-bottom: 0.5%;">
						<a href="https://discord.gg/cz5ECsdPBT" rel="nofollow noopener" title="Join the discord." target="_blank" style="padding-right: 0.5%;"><i class="fab fa-discord fa-lg"></i></a>
						<a href="https://www.patreon.com/numselli" rel="nofollow noopener" title="Become a Patreon" target="_blank"><i class="fab fa-patreon fa-lg"></i></a>
					</div>
					<div style="padding-top: 0.5%;"><a href="https://numselli.github.io" rel="nofollow noopener" title="My site." target="_blank"><span align="center">Made by numselli#6964</span></a></div>
				</div>
			</div>
		</div>

		<!-- template js -->
		<script>
			var breakpoints=function(){"use strict";function e(e){t.init(e)}var t={list:null,media:{},events:[],init:function(e){t.list=e,window.addEventListener("resize",t.poll),window.addEventListener("orientationchange",t.poll),window.addEventListener("load",t.poll),window.addEventListener("fullscreenchange",t.poll)},active:function(e){var n,a,s,i,r,d,c;if(!(e in t.media)){if(">="==e.substr(0,2)?(a="gte",n=e.substr(2)):"<="==e.substr(0,2)?(a="lte",n=e.substr(2)):">"==e.substr(0,1)?(a="gt",n=e.substr(1)):"<"==e.substr(0,1)?(a="lt",n=e.substr(1)):"!"==e.substr(0,1)?(a="not",n=e.substr(1)):(a="eq",n=e),n&&n in t.list)if(i=t.list[n],Array.isArray(i)){if(r=parseInt(i[0]),d=parseInt(i[1]),isNaN(r)){if(isNaN(d))return;c=i[1].substr(String(d).length)}else c=i[0].substr(String(r).length);if(isNaN(r))switch(a){case"gte":s="screen";break;case"lte":s="screen and (max-width: "+d+c+")";break;case"gt":s="screen and (min-width: "+(d+1)+c+")";break;case"lt":s="screen and (max-width: -1px)";break;case"not":s="screen and (min-width: "+(d+1)+c+")";break;default:s="screen and (max-width: "+d+c+")"}else if(isNaN(d))switch(a){case"gte":s="screen and (min-width: "+r+c+")";break;case"lte":s="screen";break;case"gt":s="screen and (max-width: -1px)";break;case"lt":s="screen and (max-width: "+(r-1)+c+")";break;case"not":s="screen and (max-width: "+(r-1)+c+")";break;default:s="screen and (min-width: "+r+c+")"}else switch(a){case"gte":s="screen and (min-width: "+r+c+")";break;case"lte":s="screen and (max-width: "+d+c+")";break;case"gt":s="screen and (min-width: "+(d+1)+c+")";break;case"lt":s="screen and (max-width: "+(r-1)+c+")";break;case"not":s="screen and (max-width: "+(r-1)+c+"), screen and (min-width: "+(d+1)+c+")";break;default:s="screen and (min-width: "+r+c+") and (max-width: "+d+c+")"}}else s="("==i.charAt(0)?"screen and "+i:i;t.media[e]=!!s&&s}return t.media[e]!==!1&&window.matchMedia(t.media[e]).matches},on:function(e,n){t.events.push({query:e,handler:n,state:!1}),t.active(e)&&n()},poll:function(){var e,n;for(e=0;e<t.events.length;e++)n=t.events[e],t.active(n.query)?n.state||(n.state=!0,n.handler()):n.state&&(n.state=!1)}};return e._=t,e.on=function(e,n){t.on(e,n)},e.active=function(e){return t.active(e)},e}();!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.breakpoints=t()}(this,function(){return breakpoints});
			(function ($) {
				var $window = $(window),$main = $('#main'),$panels = $main.children('.panel'),$nav = $('#nav'), $nav_links = $nav.children('a');
				breakpoints({xlarge: ['1281px', '1680px'],large: ['981px', '1280px'],medium: ['737px', '980px'],small: ['361px', '736px'],xsmall: [null, '360px']});
				// Initialize
				var $panel, $link;
				if (window.location.hash) {
					$panel = $panels.filter(window.location.hash);
					$link = $nav_links.filter(`[href="${window.location.hash}"]`);
				}
				if (!$panel|| $panel.length == 0) {
					$panel = $panels.first();
					$link = $nav_links.first();
				}
				$panels.not($panel).addClass('inactive').hide();
				$link.addClass('active');
				$window.scrollTop(0);

				// Hashchange event.
				$window.on('hashchange', function (event) {
					var $panel, $link;
					if (window.location.hash) {
						$panel = $panels.filter(window.location.hash);
						$link = $nav_links.filter(`[href="${window.location.hash}"]`);
						if ($panel.length == 0) return;
					}else {
						$panel = $panels.first();
						$link = $nav_links.first();
					}
					$panels.addClass('inactive');
					$nav_links.removeClass('active');
					$link.addClass('active');
					$main.css('max-height', `${$main.height()}px`).css('min-height', `${$main.height()}px`);
					setTimeout(function () {
						$panels.hide();
						$panel.show();
						$main.css('max-height', `${$panel.outerHeight()}px`).css('min-height', `${$panel.outerHeight()}px`);
						$window.scrollTop(0);
						window.setTimeout(function () {
							$panel.removeClass('inactive');
							$main.css('max-height', '').css('min-height', '');
							locked = false;
						}, (breakpoints.active('small') ? 0 : 500));
					}, 250);
				});
			})(jQuery);
		</script>
	</body>
</html>
